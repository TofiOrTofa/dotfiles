# ============================================
# Vim-style i3wm с режимами и Alt как модификатор
# ============================================

# Модификатор - Win
set $mod Mod4

# Отключаем стандартный Alt поведение (меню, переключение раскладки)
# Важно: переназначить переключение раскладки на другую комбинацию!
#exec --no-startup-id setxkbmap -option "altwin:menu_win"

# Режимы
set $mode_default "РАБОТА В ОКНАХ (F1 справка)"
set $mode_window "УПРАВЛЕНИЕ ОКНАМИ (Esc выход)"

# ============================================
# РЕЖИМ ПО УМОЛЧАНИЮ - для работы в приложениях
# ============================================
mode "$mode_default" {
    # Выход из i3
    bindsym $mod+Shift+q exec "i3-nagbar -t warning -m 'Выйти из i3?' -b 'Да' 'i3-msg exit'"
    
    # Переключение режимов
    bindsym $mod mode "$mode_window"
    
    # Вернуться в режим окон (на случай переключения)
    bindsym Escape mode "$mode_window"

    bindsym $mod+1 workspace number 1
    bindsym $mod+2 workspace number 2
    bindsym $mod+3 workspace number 3
    bindsym $mod+4 workspace number 4
    bindsym $mod+5 workspace number 5
    bindsym $mod+6 workspace number 6
    bindsym $mod+7 workspace number 7
    bindsym $mod+8 workspace number 8
    bindsym $mod+9 workspace number 9
    bindsym $mod+0 workspace number 10

}

# ============================================
# РЕЖИМ УПРАВЛЕНИЯ ОКНАМИ (Vim-стиль)
# ============================================
mode "$mode_window" {
    # ----- НАВИГАЦИЯ МЕЖДУ ОКНАМИ -----
    bindsym h focus left
    bindsym j focus down
    bindsym k focus up
    bindsym l focus right
    
    # ----- ПЕРЕМЕЩЕНИЕ ОКОН -----
    bindsym Shift+h move left
    bindsym Shift+j move down
    bindsym Shift+k move up
    bindsym Shift+l move right
    
    # ----- ИЗМЕНЕНИЕ РАЗМЕРА ОКОН -----
    bindsym Ctrl+h resize shrink width 10 px or 10 ppt
    bindsym Ctrl+j resize grow height 10 px or 10 ppt
    bindsym Ctrl+k resize shrink height 10 px or 10 ppt
    bindsym Ctrl+l resize grow width 10 px or 10 ppt
    
    # ----- УПРАВЛЕНИЕ ОКНАМИ -----
    bindsym f fullscreen toggle
    bindsym v split vertical
    bindsym s split horizontal
    bindsym w split toggle
    bindsym q kill
    bindsym r restart
    
    # ----- РАБОЧИЕ ПРОСТРАНСТВА -----
    bindsym 1 workspace number 1
    bindsym 2 workspace number 2
    bindsym 3 workspace number 3
    bindsym 4 workspace number 4
    bindsym 5 workspace number 5
    bindsym 6 workspace number 6
    bindsym 7 workspace number 7
    bindsym 8 workspace number 8
    bindsym 9 workspace number 9
    bindsym 0 workspace number 10
    
    bindsym Shift+1 move container to workspace number 1
    bindsym Shift+2 move container to workspace number 2
    bindsym Shift+3 move container to workspace number 3
    bindsym Shift+4 move container to workspace number 4
    bindsym Shift+5 move container to workspace number 5
    bindsym Shift+6 move container to workspace number 6
    bindsym Shift+7 move container to workspace number 7
    bindsym Shift+8 move container to workspace number 8
    bindsym Shift+9 move container to workspace number 9
    bindsym Shift+0 move container to workspace number 10
    
    # ----- ПЕРЕКЛЮЧЕНИЕ РАБОЧИХ ПРОСТРАНСТВ -----
    bindsym Tab workspace next
    bindsym Shift+Tab workspace prev
    
    # ----- ЗАПУСК ПРИЛОЖЕНИЙ -----
    bindsym Return exec alacritty
    bindsym e exec thunar
    bindsym b exec firefox
    bindsym c exec codium
    
    # ----- СПЕЦИАЛЬНЫЕ КОМАНДЫ -----
    bindsym d exec --no-startup-id "rofi -show drun"
    bindsym Shift+d exec --no-startup-id "rofi -show run"
    bindsym m exec --no-startup-id "rofi -show window"
    
    # ----- ПЕРЕЗАГРУЗКА И ВЫХОД -----
    bindsym Shift+r restart
    bindsym Shift+c reload
    bindsym Shift+e exec "i3-nagbar -t warning -m 'Выйти из i3?' -b 'Да' 'i3-msg exit'"
    
    # ----- ВЫХОД ИЗ РЕЖИМА -----
    bindsym Escape mode "$mode_default"
    bindsym F1 mode "$mode_default"
}

# ============================================
# ГЛОБАЛЬНЫЕ НАСТРОЙКИ
# ============================================

# Запускаемся в режиме окон
mode "$mode_window"

# Окружение по умолчанию
exec --no-startup-id setxkbmap -model pc105 -layout us,ru -option grp:win_space_toggle
exec --no-startup-id nm-applet
exec --no-startup-id blueman-applet
#exec --no-startup-id picom --config ~/.config/picom.conf

# Цвета и оформление
client.focused          #2e3440 #88c0d0 #2e3440 #88c0d0
client.focused_inactive #3b4252 #81a1c1 #3b4252 #81a1c1
client.unfocused        #2e3440 #4c566a #2e3440 #4c566a

# Плавающие окна
for_window [class="floating"] floating enable

# Автозапуск
exec --no-startup-id alacritty
